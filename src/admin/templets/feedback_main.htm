<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<title><?php echo Lang('feedback_main');?></title>
	<link rel="stylesheet" href="../static/web/css/bootstrap.min.css">
	<link rel="stylesheet" href="../static/web/font/css/font-awesome.min.css">
	<link rel="stylesheet" href="../static/web/css/admin.min.css">
	<?php include_once(DEDEADMIN.'/templets/_widget_lang.htm');?>
	<script src="../static/web/js/jquery.min.js"></script>
	<script src="../static/web/js/bootstrap.bundle.min.js"></script>
	<script src="js/main.js"></script>
	<script>
		//获得选中文件的文件名
		function getCheckboxItem() {
			var allSel = "";
			if (document.feedback.fid.value) return document.feedback.fid.value;
			for (i = 0; i < document.feedback.fid.length; i++) {
				if (document.feedback.fid[i].checked) {
					if (allSel == "")
						allSel = document.feedback.fid[i].value;
					else
						allSel = allSel + "," + document.feedback.fid[i].value;
				}
			}
			return allSel;
		}
		function selAll() {
			if (typeof document.feedback.fid === "object") {
				document.feedback.fid.checked = true;
			}
			for (i = 0; i < document.feedback.fid.length; i++) {
				document.feedback.fid[i].checked = true;
			}
		}
		function selNone() {
			if (typeof document.feedback.fid === "object") {
				document.feedback.fid.checked = false;
			}
			for (i = 0; i < document.feedback.fid.length; i++) {
				document.feedback.fid[i].checked = false;
			}
		}
		function selNor() {
			for (i = 0; i < document.feedback.fid.length; i++) {
				if (document.feedback.fid[i].checked == false)
					document.feedback.fid[i].checked = true;
				else
					document.feedback.fid[i].checked = false;
			}
		}
		function delFeedback() {
			var qstr = getCheckboxItem();
			if (qstr == "") ShowMsg("<?php echo Lang('feedback_noselect');?>");
			else if (window.confirm("<?php echo Lang('feedback_want_delete');?>")) location.href = "feedback_main.php?job=del&fid=" + qstr;
		}
		function delFeedbackIP() {
			var qstr = getCheckboxItem();
			if (qstr == "") ShowMsg("<?php echo Lang('feedback_noselect');?>");
			else if (window.confirm("<?php echo Lang('feedback_want_delete');?>")) location.href = "feedback_main.php?job=delall&fid=" + qstr;
		}
		function checkFeedback() {
			var qstr = getCheckboxItem();
			if (qstr == "") ShowMsg("<?php echo Lang('feedback_noselect');?>");
			else location.href = "feedback_main.php?job=check&fid=" + qstr;
		}
		function editFeedback() {
			var qstr = getCheckboxItem();
			if (qstr == "") ShowMsg("<?php echo Lang('feedback_noselect');?>");
			else location.href = "feedback_edit.php?job=edit&fid=" + qstr;
		}
	</script>
</head>
<body>
	<table width="98%" align="center" cellpadding="3" cellspacing="1" class="table maintable mt-3 mb-3">
		<tr>
			<td bgcolor="#f8f8f8">
				<span class="float-left py-2"><?php echo Lang('feedback_main');?></span>
				<span class="float-right mr-2">
					<form name="form1">
						<input type="text" name="keyword" placeholder="<?php echo Lang('input_keywords_tip');?>" style="width:160px">
						<select name="typeid" style="margin:0 10px;width:160px">
							<option value="0"><?php echo Lang('select');?>...</option>
							{dede:global.openarray/}
						</select>
						<button type="submit" class="btn btn-success btn-sm"><?php echo Lang('search');?></button>
					</form>
				</span>
			</td>
		</tr>
		<form name="feedback">
			<tr>
				<td class="p-0">
					<table width="100%" cellpadding="0" cellspacing="0" class="table">
						{dede:datalist empty='<tr><td colspan="6" class="border-top-0"><center>~lang:none_result~</center></td></tr>'}
						<tr>
							<td width="8%"><?php echo Lang('select');?> <input type="checkbox" name="fid" id="fid" value="{dede:field.id/}"></td>
							<td width="10%"><?php echo Lang('user');?>：{dede:field.username/}</td>
							<td width="30%">
								<?php echo Lang('content');?>：<a href='feedback_main.php?aid={dede:field.aid/}'>{dede:field.arctitle function="RemoveXSS(@me)"/}</a> (<a href="archives_do.php?aid={dede:field.aid/}&dopost=viewArchives" target="_blank"><?php echo Lang('view');?></a>)
								<?php if ($fields['replycount'] > 0) {?><a href='feedback_main.php?fid={dede:field.id/}'>（{dede:field.replycount/}<?php echo Lang('feedback_count');?>）</a>
								<?php }?>
							</td>
							<td width="12%">IP：<a href='feedback_main.php?ip={dede:field.ip/}'>{dede:field.ip/}</a></td>
							<td width="12%"><?php echo Lang('time');?>：{dede:field.dtime function="GetDateTimeMK(@me)"/}</td>
							<td align="center">
								<a class="btn btn-success btn-sm" href='feedback_edit.php?id={dede:field.id/}'><?php echo Lang('edit');?></a>
								<a class="btn btn-success btn-sm" href='feedback_edit.php?id={dede:field.id/}&dopost=makehtml'><?php echo Lang('update');?></a>
							</td>
						</tr>
						<tr>
							<td colspan="6">
								{dede:field.ischeck function="IsCheck(@me)"/}
								{dede:field.msg function='cn_substr(Text2Html(@me),280)'/}
							</td>
						</tr>
						{/dede:datalist}
						<tr>
							<td align="right" colspan="6">
								<button type="button" name="kk1" onClick="selAll()" class="btn btn-success btn-sm"><?php echo Lang('select_all');?></button>
								<button type="button" name="kk2" onClick="selNone()" class="btn btn-success btn-sm"><?php echo Lang('cancel');?></button>
								<button type="button" name="kk3" onClick="selNor()" class="btn btn-success btn-sm"><?php echo Lang('reverse_selection');?></button>
								<button type="button" name="db" onClick="delFeedbackIP()" class="btn btn-danger btn-sm"><?php echo Lang('feedback_delete_ip');?></button>
								<button type="button" name="db" onClick="delFeedback()" class="btn btn-success btn-sm"><?php echo Lang('feedback_delete');?></button>
								<button type="button" name="db2" onClick="checkFeedback()" class="btn btn-success btn-sm"><?php echo Lang('feedback_check');?></button>
							</td>
						</tr>
						<tr>
							<td align="center" bgcolor="#f8f8f8" colspan="6" class="py-2">{dede:pagelist listsize='6'/}</td>
						</tr>
					</table>
				</td>
			</tr>
		</form>
	</table>
</body>
</html>