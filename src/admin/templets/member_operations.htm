<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <title><?php echo Lang('member_operations');?></title>
  <link rel="stylesheet" href="../static/web/css/bootstrap.min.css">
  <link rel="stylesheet" href="../static/web/font/css/font-awesome.min.css">
  <link rel="stylesheet" href="../static/web/css/admin.min.css">
  <script>
    //获得选中项
    function getCheckboxItem() {
      var allSel = "";
      if (document.form1.aids.value) return document.form1.aids.value;
      for (i = 0; i < document.form1.aids.length; i++) {
        if (document.form1.aids[i].checked) {
          if (allSel == "")
            allSel = document.form1.aids[i].value;
          else
            allSel = allSel + "`" + document.form1.aids[i].value;
        }
      }
      return allSel;
    }
    function ReSel() {
      for (i = 0; i < document.form1.aids.length; i++) {
        if (document.form1.aids[i].checked) document.form1.aids[i].checked = false;
        else document.form1.aids[i].checked = true;
      }
    }
    function DelSel() {
      var nid = getCheckboxItem();
      if (nid == "") {
        alert("请选择要删除的业务记录");
        return;
      }
      location.href = "member_do.php?dopost=deoperations&nid=" + nid;
    }
    function UpSel() {
      var nid = getCheckboxItem();
      if (nid == "") {
        alert("请选择要修改的业务记录");
        return;
      }
      location.href = "member_do.php?dopost=upoperations&nid=" + nid;
    }
    function OkSel() {
      var nid = getCheckboxItem();
      if (nid == "") {
        alert("请选择要修改的业务记录");
        return;
      }
      location.href = "member_do.php?dopost=okoperations&nid=" + nid;
    }
  </script>
</head>
<body>
  <form name="form2" method="get" action="member_operations.php">
    <table width="98%" align="center" cellpadding="1" cellspacing="1" class="mt-3 mb-3 biz-border">
      <tr>
        <td height="36" bgcolor="#f8f8f8">
          <table cellpadding="0" cellspacing="0">
            <tr>
              <td width="280" align="center"><input type="text" name="buyid" id="buyid" placeholder="<?php echo Lang('member_operations_input_buyid');?>" style="width:260px"></td>
              <td><button type="submit" class="btn btn-success btn-sm"><?php echo Lang('search');?></button></td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
  </form>
  <table width="98%" align="center" cellpadding="1" cellspacing="1" class="table maintable mb-3">
    <tr>
      <td bgcolor="f8f8f8" colspan="8">
        <table width="98%" cellspacing="0" cellpadding="0" class="table table-borderless">
          <tr>
            <td width="30%"><?php echo Lang('member_operations');?></td>
            <td width="45%" align="right">
              <button type="button" onClick="location='member_operations.php?sta=0';" class="btn btn-success btn-sm"><?php echo Lang('member_operations_sta_0');?></button>
              <button type="button" onClick="location='member_operations.php?sta=1';" class="btn btn-success btn-sm"><?php echo Lang('member_operations_sta_1');?></button>
              <button type="button" onClick="location='member_operations.php?sta=2';" class="btn btn-success btn-sm"><?php echo Lang('member_operations_sta_2');?></button>
              <button type="button" onClick="location='member_operations.php';" class="btn btn-success btn-sm"><?php echo Lang('member_operations_sta_all');?></button>
            </td>
            <td width="25%" align="right"><button type="button" onClick="location='member_main.php';" class="btn btn-success btn-sm"><?php echo Lang('member_main');?></button></td>
          </tr>
        </table>
      </td>
    </tr>
    <tr bgcolor="#f8fcf2">
      <td width="8%" align="center"><?php echo Lang('select');?></td>
      <td width="20%" align="center"><?php echo Lang('member_buyid');?></td>
      <td align="center"><?php echo Lang('member_pname');?></td>
      <td width="10%" align="center"><?php echo Lang('member_ptype');?></td>
      <td width="22%" align="center"><?php echo Lang('cards_mtime');?></td>
      <td width="8%" align="center"><?php echo Lang('member_operations_money');?></td>
      <td width="8%" align="center"><?php echo Lang('status');?></td>
      <td width="10%" align="center"><?php echo Lang('member');?></td>
    </tr>
    <form name="form1">
      {dede:datalist empty='<tr><td colspan="8"><center>~lang:none_result~</center></td></tr>'}
      <tr align="center" onmousemove="javascript:this.bgColor='#f8fcf2';" onmouseout="javascript:this.bgColor='#ffffff';">
        <td align="center"><input type="checkbox" name="aids" value="<?php echo $fields['aid']?>"></td>
        <td align="center"><?php echo $fields['buyid']?></td>
        <td align="center"><?php echo $fields['pname'].'('.$fields['oldinfo'].')';?></td>
        <td align="center"><?php echo GetPType($fields['product'])?></td>
        <td align="center"><?php echo GetDateTimeMk($fields['mtime'])?>（{dede:field.mtime function="floorTime(time()-@me,@me)"/}）</td>
        <td align="center"><?php echo $fields['money']?></td>
        <td align="center"><?php echo GetSta($fields['sta'])?></td>
        <td align="center"><?php echo GetMemberID($fields['mid'])?></td>
      </tr>
      {/dede:datalist}
    </form>
    <tr>
      <td colspan="8">
        <button type="button" onClick="ReSel();" class="btn btn-success btn-sm"><?php echo Lang('reverse_selection');?></button>
        <button type="button" onClick="DelSel();" class="btn btn-danger btn-sm"><?php echo Lang('delete');?></button>
        <button type="button" onClick="UpSel();" class="btn btn-success btn-sm"><?php echo Lang('member_operations_upsel');?></button>
        <button type="button" onClick="OkSel();" class="btn btn-success btn-sm"><?php echo Lang('member_operations_oksel');?></button>
      </td>
    </tr>
    <tr>
      <td align="center" colspan="8" bgcolor="#f8f8f8" class="py-2">{dede:pagelist listitem='info,index,end,pre,next,pageno' listsize='6'/}</td>
    </tr>
  </table>
</body>
</html>