<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
		<title>新建修改模板</title>
		<link rel="stylesheet" href="../static/web/font/css/font-awesome.min.css">
		<link rel="stylesheet" href="../static/web/css/bootstrap.min.css">
		<link rel="stylesheet" href="../static/web/css/admin.css">
		<link rel="stylesheet" href="css/codemirror.css">
		<script src="js/codemirror.js"></script>
		<script src="js/mode/xml/xml.js"></script>
		<script src="js/mode/javascript/javascript.js"></script>
		<script src="js/mode/css/css.js"></script>
		<script src="js/mode/htmlmixed/htmlmixed.js"></script>
		<style>.selbt{float:left;display:inline-block;margin:2px;text-align:center;border-radius:.2rem}.helpdiv{float:left;display:none;padding:10px;width:100%;background:#f5f5f5;border:1px solid #dee2e6;border-radius:.2rem}</style>
		<script>
			function Post() {
				if (document.form1.filename.value == "") {
					alert("文件名不能为空");
					document.form1.filename.focus();
					return false;
				}
			}
			function showdiv(id) {
				hideobj = GETNAMES("help111");
				for (i = 0; i < hideobj.length; i++) {
					hideobj[i].style.display = "none";
				}
				if (id != '') {
					document.getElementById(id).style.display = "block";
				}
			}
			function GETNAMES(name) {
				var returns = document.getElementsByName(name);
				if (returns.length > 0) return returns;
				returns = new Array();
				var e = document.getElementsByTagName('div');
				for (i = 0; i < e.length; i++) {
					if (e[i].getAttribute("name") == name) {
						returns[returns.length] = e[i];
					}
				}
				return returns;
			}
		</script>
	</head>
	<body>
		<form method="POST" action="tpl.php" name=form1 onSubmit="return Post()">
			<input type="hidden" name="action" value="saveedit">
			<input type="hidden" name="acdir" value="<?php echo $acdir;?>">
			<input type="hidden" name="_csrf_token" value="<?php echo $GLOBALS['csrf_token'];?>">
			<table cellpadding="3" cellspacing="1" align="center" class="table maintable my-3">
				<tr>
					<td bgcolor="#f5f5f5" colspan="2">新建修改模板</td>
				</tr>
				<tr>
					<td width="260">文件名称</td>
					<td><input name=filename value="<?php echo $filename;?>" class="admin-input-md">（不允许用“..”形式的路径）</td>
				</tr>
				<tr>
					<td colspan="2">参考标签：</td>
				</tr>
				<tr>
					<td colspan="2">
					<?php
					foreach ($helps as $key => $help) {
						echo '<div title="'.trim($help[0]).'" class="selbt"><a href="javascript:;" onclick="showdiv(\''.$key.'\');" class="btn btn-success btn-sm">'.$key.'</a></div>'."";
					}
					?>
					</td>
				</tr>
				<tr>
					<td colspan="2" style="border-top:1px solid #fff">
						<?php
						foreach ($helps as $key => $help) {
							echo '<div name="help111" id="'.$key.'" class="helpdiv"><span class="float-right"><a href="javascript:;" onclick="showdiv(\'\')" class="btn btn-success btn-sm">关闭</a></span>标签名称：'.$key.'<br>功能说明：'.trim($help[0]).'<br>使用实例：<br><textarea class="admin-textarea-xl">'.trim($help[1]).'</textarea><br>参数说明：<br>'."";
							$parameters = explode("\n", $help[2]);
							foreach($parameters as $parameter)
							{
								$parameter = trim($parameter);
								if ($parameter == '') continue;
								else echo $parameter,'<br>';
							}
						echo '</div>'."";
						}
						?>
					</td>
				</tr>
				<tr>
					<td colspan="2" class="p-0">
						<textarea id="content" name="content" class="admin-textarea-xl"><?php echo $content;?></textarea>
					</td>
				</tr>
				<tr>
					<td bgcolor="#f5f5f5" colspan="2" align="center">
						<button type="submit" name="B1" class="btn btn-success btn-sm">保存</button>
						<button type="button" name="B4" class="btn btn-success btn-sm" onClick="javascript:history.go(-1);">返回</button>
					</td>
				</tr>
			</table>
		</form>
		<script>
			var editor = CodeMirror.fromTextArea(document.getElementById('content'), {
				lineNumbers: true,
				lineWrapping: true,
				mode: 'text/html'
			});
		</script>
	</body>
</html>