<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
		<title><?php echo Lang('tpl_edit');?></title>
		<link rel="stylesheet" href="../static/web/css/bootstrap.min.css">
		<link rel="stylesheet" href="../static/web/font/css/font-awesome.min.css">
		<link rel="stylesheet" href="../static/web/css/admin.min.css">
		<style>
			.selbt {
				float: left;
				display: inline-block;
				margin: 2px;
				text-align: center;
				border-radius: .2rem
			}
			.helpdiv {
				float: left;
				display: none;
				padding: 10px;
				width: 100%;
				background: #f8f8f8;
				border: 1px solid #dee2e6;
				border-radius: .2rem
			}
		</style>
		<link rel="stylesheet" href="css/codemirror.css">
		<script src="js/codemirror.js"></script>
		<script src="js/mode/xml/xml.js"></script>
		<script src="js/mode/javascript/javascript.js"></script>
		<script src="js/mode/css/css.js"></script>
		<script src="js/mode/htmlmixed/htmlmixed.js"></script>
		<script>
			function Post() {
				if (document.form1.filename.value == "") {
					alert("<?php echo Lang('templets_one_err_nfilename_isempty');?>");
					document.form1.filename.focus();
					return false;
				}
			}
			function showdiv(id) {
				hideobj = GETNAMES("help111");
				for (i = 0; i < hideobj.length; i++) {
					hideobj[i].style.display = "none";
				}
				if (id != '') {
					document.getElementById(id).style.display = "block";
				}
			}
			function GETNAMES(name) {
				var returns = document.getElementsByName(name);
				if (returns.length > 0) return returns;
				returns = new Array();
				var e = document.getElementsByTagName('div');
				for (i = 0; i < e.length; i++) {
					if (e[i].getAttribute("name") == name) {
						returns[returns.length] = e[i];
					}
				}
				return returns;
			}
		</script>
	</head>
	<body>
		<form method="POST" action="tpl.php" name=form1 onSubmit="return Post()">
			<input type="hidden" name="action" value="saveedit">
			<input type="hidden" name="acdir" value="<?php echo $acdir;?>">
			<input type="hidden" name="_csrf_token" value="<?php echo $GLOBALS['csrf_token'];?>">
			<table width="98%" align="center" cellpadding="3" cellspacing="1" class="table maintable mt-3 mb-3">
				<tr>
					<td bgcolor="#f8f8f8" colspan="2"><?php echo Lang('tpl_edit');?></td>
				</tr>
				<tr>
					<td><?php echo Lang('content_filename');?></td>
					<td><input name=filename value="<?php echo $filename;?>" style="width:260px"><?php echo Lang('tpl_edit_filename_tip');?></td>
				</tr>
				<tr>
					<td colspan="2"><?php echo Lang('tpl_tag');?>：</td>
				</tr>
				<tr>
					<td colspan="2">
					<?php
					foreach ($helps as $key => $help) {
						echo '<div class="coolbg np selbt" title="'.trim($help[0]).'"><a href="javascript:;" onclick="showdiv(\''.$key.'\');"> '.$key.' </a></div>'."";
					}
					?>
					</td>
				</tr>
				<tr>
					<td colspan="2" style="border-top:1px solid #fff">
					<?php
					foreach ($helps as $key => $help) {
						echo '<div name="help111" id="'.$key.'" class="helpdiv"><span class="float-right"><a href="javascript:;" onclick="showdiv(\'\')" class="btn btn-success btn-sm">'.Lang('close').'</a></span>'.Lang('tpl_tag_name').'：'.$key.'<br>'.Lang('tpl_tag_desc').'：'.trim($help[0]).'<br>'.Lang('tpl_tag_ues').'：<br><textarea rows="5" style="width:98%">'.trim($help[1]).'</textarea><br>'.Lang('tpl_tag_parm').'：<br>'."";
						$parameters = explode("\n", $help[2]);
						foreach($parameters as $parameter)
						{
							$parameter = trim($parameter);
							if ($parameter == '') continue;
							else echo $parameter,'<br>';
						}
					echo '</div>'."";
					}
					?>
					</td>
				</tr>
				<tr>
					<td colspan="2" class="p-0"><textarea id="content" name="content" style="width:100%;height:450px"><?php echo $content;?></textarea></td>
				</tr>
				<tr>
					<td align="center" colspan="2" bgcolor="#f8f8f8" class="py-2">
						<button type="submit" name="B1" class="btn btn-success btn-sm"><?php echo Lang('save');?></button>
						<button type="button" name="B4" class="btn btn-success btn-sm" onClick="javascript:history.go(-1);"><?php echo Lang('back');?></button>
					</td>
				</tr>
			</table>
		</form>
		<script>
			var editor = CodeMirror.fromTextArea(document.getElementById('content'), {
				lineNumbers: true,
				lineWrapping: true,
				mode: 'text/html'
			});
		</script>
	</body>
</html>