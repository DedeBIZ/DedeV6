<!DOCTYPE html>
<html>
<head>
  <meta charset="<?php echo $cfg_soft_lang; ?>">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <title>采集内容管理</title>
  <link rel="stylesheet" href="../static/web/css/bootstrap.min.css">
  <link rel="stylesheet" href="../static/web/font/css/font-awesome.min.css">
  <link rel="stylesheet" href="../static/web/css/admin.css">
  <script>
    //获得选中文件的文件名
    function getCheckboxItem() {
      var allSel = "";
      if (document.form1.logs.value) return document.form1.logs.value;
      for (i = 0; i < document.form1.logs.length; i++) {
        if (document.form1.logs[i].checked) {
          if (allSel == "")
            allSel = document.form1.logs[i].value;
          else
            allSel = allSel + "`" + document.form1.logs[i].value;
        }
      }
      return allSel;
    }
    function ReSel() {
      for (i = 0; i < document.form1.logs.length; i++) {
        if (document.form1.logs[i].checked) document.form1.logs[i].checked = false;
        else document.form1.logs[i].checked = true;
      }
    }
    function DelSel() {
      var nid = getCheckboxItem();
      if (nid == "") {
        alert("请选择项目");
        return;
      }
      location.href = "log_edit.php?dopost=del&ids=" + nid;
    }
    function ClearLog() {
      location.href = "log_edit.php?dopost=clear";
    }
  </script>
</head>
<body>
  <table width="98%" cellpadding="2" cellspacing="1" align="center" class="table maintable mt-3 mb-3">
    <tr>
      <td bgcolor="#f8f8f8" colspan="7">
        <table width="98%" cellpadding="0" cellspacing="0" class="table table-borderless">
          <tr>
            <td width="30%">管理系统日志</td>
            <td width="70%" align="right"></td>
          </tr>
        </table>
      </td>
    </tr>
    <tr align="center">
      <td colspan="7">
        <table width="100%" cellspacing="0" cellpadding="0" class="table-borderless">
          <form name="formsearch">
            <tr>
              <td width="180" align="center">
                <select name="adminid" id="adminid" style="width:160px">
                  <option value="0" selected>全部</option>
                  <?php echo $adminlist?>
                </select>
              </td>
              <td width="170"><input type="text" name="cip" id="cip" placeholder="请输入IP地址" style="width:160px"></td>
              <td width="170">
                <select name="dtime" id="dtime" style="width:160px">
                  <option value="0" selected>全部</option>
                  <option value="7">一周内</option>
                  <option value="15">15天内</option>
                  <option value="30">30天以内</option>
                  <option value="60">60天以内</option>
                </select>
              </td>
              <td><button type="submit" class="btn btn-success btn-sm">搜索</button></td>
            </tr>
          </form>
        </table>
      </td>
    </tr>
    <tr bgcolor="#FBFCE2" align="center">
      <td width="8%">选择</td>
      <td width="11%">管理员</td>
      <td width="15%">访问文件</td>
      <td width="8%">方式</td>
      <td width="14%">访问IP</td>
      <td width="16%">时间</td>
      <td width="28%">Query参数</td>
    </tr>
    <form name="form1">
      {dede:datalist empty='<tr><td colspan="7"><center>暂无内容</center></td></tr>'}
      <tr align="center" onmousemove="javascript:this.bgColor='#FBFCE2';" onmouseout="javascript:this.bgColor='#ffffff';">
        <td><input type="checkbox" name="logs" id="logs" value="{dede:field.lid/}"></td>
        <td>{dede:field.userid/}</td>
        <td><input type="text" value="{dede:field.filename/}" name="t0" style="width:100px"></td>
        <td>{dede:field.method/}</td>
        <td>{dede:field.cip/}</td>
        <td>{dede:field.dtime function="MyDate('y/m/d H:i:s',@me)"/}</td>
        <td><input type="text" value="{dede:field.query/}" name="t1" style="width:280px"></td>
      </tr>
      {/dede:datalist}
    </form>
    <tr>
      <td colspan="7">
        <button type="button" onClick="ReSel();" class="btn btn-success btn-sm">反选</button>
        <button type="button" onClick="DelSel();" class="btn btn-danger btn-sm">删除</button>
        <button type="button" onClick="ClearLog();" class="btn btn-success btn-sm">清空所有日志</button>
      </td>
    </tr>
    <tr>
      <td height="36" bgcolor="#f8f8f8" colspan="7" align="center">{dede:pagelist listsize='6'/}</td>
    </tr>
  </table>
</body>
</html>