<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <title><?php echo Lang('log_list');?></title>
  <link rel="stylesheet" href="../static/web/css/bootstrap.min.css">
  <link rel="stylesheet" href="../static/web/font/css/font-awesome.min.css">
  <link rel="stylesheet" href="../static/web/css/admin.min.css">
  <script>
    //获得选中文件的文件名
    function getCheckboxItem() {
      var allSel = "";
      if (document.form1.logs.value) return document.form1.logs.value;
      for (i = 0; i < document.form1.logs.length; i++) {
        if (document.form1.logs[i].checked) {
          if (allSel == "")
            allSel = document.form1.logs[i].value;
          else
            allSel = allSel + "`" + document.form1.logs[i].value;
        }
      }
      return allSel;
    }
    function ReSel() {
      for (i = 0; i < document.form1.logs.length; i++) {
        if (document.form1.logs[i].checked) document.form1.logs[i].checked = false;
        else document.form1.logs[i].checked = true;
      }
    }
    function DelSel() {
      var nid = getCheckboxItem();
      if (nid == "") {
        alert("<?php echo Lang('admin_err_select_none');?>");
        return;
      }
      location.href = "log_edit.php?dopost=del&ids=" + nid;
    }
    function ClearLog() {
      location.href = "log_edit.php?dopost=clear";
    }
  </script>
</head>
<body>
  <table width="98%" align="center" cellpadding="2" cellspacing="1" class="table maintable mt-3 mb-3">
    <tr>
      <td bgcolor="#f8f8f8" colspan="7">
        <table width="98%" cellpadding="0" cellspacing="0" class="table table-borderless">
          <tr>
            <td width="30%"><?php echo Lang('log_list');?></td>
            <td width="70%" align="right"></td>
          </tr>
        </table>
      </td>
    </tr>
    <tr align="center">
      <td colspan="7">
        <table width="100%" cellspacing="0" cellpadding="0" class="table-borderless">
          <form name="formsearch">
            <tr>
              <td width="180" align="center">
                <select name="adminid" id="adminid" style="width:160px">
                  <option value="0" selected><?php echo Lang('all');?></option>
                  <?php echo $adminlist?>
                </select>
              </td>
              <td width="170"><input type="text" name="cip" id="cip" placeholder="<?php echo Lang('log_list_input_ip_tip');?>" style="width:160px"></td>
              <td width="170">
                <select name="dtime" id="dtime" style="width:160px">
                  <option value="0" selected><?php echo Lang('all');?></option>
                  <option value="7"><?php echo Lang('log_list_dtime_7');?></option>
                  <option value="15"><?php echo Lang('log_list_dtime_15');?></option>
                  <option value="30"><?php echo Lang('log_list_dtime_30');?></option>
                  <option value="60"><?php echo Lang('log_list_dtime_60');?></option>
                </select>
              </td>
              <td><button type="submit" class="btn btn-success btn-sm"><?php echo Lang('search');?></button></td>
            </tr>
          </form>
        </table>
      </td>
    </tr>
    <tr align="center" bgcolor="#f8fcf2">
      <td width="8%"><?php echo Lang('select');?></td>
      <td width="11%"><?php echo Lang('administrator');?></td>
      <td width="15%"><?php echo Lang('log_list_filename');?></td>
      <td width="8%"><?php echo Lang('log_list_method');?></td>
      <td width="14%">IP</td>
      <td width="16%"><?php echo Lang('time');?></td>
      <td width="28%"><?php echo Lang('log_list_query');?></td>
    </tr>
    <form name="form1">
      {dede:datalist empty='<tr><td colspan="7"><center>~lang:none_result~</center></td></tr>'}
      <tr align="center" onmousemove="javascript:this.bgColor='#f8fcf2';" onmouseout="javascript:this.bgColor='#ffffff';">
        <td><input type="checkbox" name="logs" id="logs" value="{dede:field.lid/}"></td>
        <td>{dede:field.userid/}</td>
        <td><input type="text" value="{dede:field.filename/}" name="t0" style="width:100px"></td>
        <td>{dede:field.method/}</td>
        <td>{dede:field.cip/}</td>
        <td>{dede:field.dtime function="MyDate('y/m/d H:i:s',@me)"/}</td>
        <td><input type="text" value="{dede:field.query/}" name="t1" style="width:280px"></td>
      </tr>
      {/dede:datalist}
    </form>
    <tr>
      <td colspan="7">
        <button type="button" onClick="ReSel();" class="btn btn-success btn-sm"><?php echo Lang('reverse_selection');?></button>
        <button type="button" onClick="DelSel();" class="btn btn-danger btn-sm"><?php echo Lang('delete');?></button>
        <button type="button" onClick="ClearLog();" class="btn btn-success btn-sm"><?php echo Lang('log_list_clearlog');?></button>
      </td>
    </tr>
    <tr>
      <td  align="center" colspan="7" bgcolor="#f8f8f8" class="py-2">{dede:pagelist listsize='6'/}</td>
    </tr>
  </table>
</body>
</html>