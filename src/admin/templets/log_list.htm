<!DOCTYPE html>
<html>
<head>
  <meta charset="<?php echo $cfg_soft_lang;?>">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <title>采集内容管理</title>
  <link rel="stylesheet" href="../static/web/font/css/font-awesome.min.css">
  <link rel="stylesheet" href="../static/web/css/bootstrap.min.css">
  <link rel="stylesheet" href="../static/web/css/admin.css">
  <script>
    //获得选中文件的文件名
    function getCheckboxItem() {
      var allSel = "";
      if (document.form1.logs.value) return document.form1.logs.value;
      for (i = 0; i < document.form1.logs.length; i++) {
        if (document.form1.logs[i].checked) {
          if (allSel == "")
            allSel = document.form1.logs[i].value;
          else
            allSel = allSel + "`" + document.form1.logs[i].value;
        }
      }
      return allSel;
    }
    function ReSel() {
      for (i = 0; i < document.form1.logs.length; i++) {
        if (document.form1.logs[i].checked) document.form1.logs[i].checked = false;
        else document.form1.logs[i].checked = true;
      }
    }
    function DelSel() {
      var nid = getCheckboxItem();
      if (nid == "") {
        alert("请选择项目");
        return;
      }
      location.href = "log_edit.php?dopost=del&ids=" + nid;
    }
    function ClearLog() {
      location.href = "log_edit.php?dopost=clear";
    }
  </script>
</head>
<body>
  <form name="formsearch">
    <table width="98%" cellpadding="2" cellspacing="1" align="center" class="table maintable my-3">
      <tr bgcolor="#f8f8f8">
        <td width="180" align="center">
          <select name="adminid" id="adminid" class="biz-input-sm">
            <option value="0" selected>全部</option>
            <?php echo $adminlist?>
          </select>
        </td>
        <td width="170"><input type="text" name="cip" id="cip" placeholder="请输入ip地址" class="biz-input-sm"></td>
        <td width="170">
          <select name="dtime" id="dtime" class="biz-input-sm">
            <option value="0" selected>全部</option>
            <option value="7">一周内</option>
            <option value="15">15天内</option>
            <option value="30">30天以内</option>
            <option value="60">60天以内</option>
          </select>
        </td>
        <td><button type="submit" class="btn btn-success btn-sm">搜索</button></td>
      </tr>
    </table>
  </form>
  <table width="98%" cellpadding="2" cellspacing="1" align="center" class="table maintable mb-3">
    <tr>
      <td bgcolor="#f8f8f8" colspan="7">管理系统日志</td>
    </tr>
    <tr bgcolor="#fbfce2" align="center">
      <td width="6%">选择</td>
      <td width="10%">管理员</td>
      <td width="16%">访问文件</td>
      <td width="6%">方式</td>
      <td width="14%">访问ip</td>
      <td width="16%">时间</td>
      <td>Query参数</td>
    </tr>
    <form name="form1">
      {dede:datalist empty='<tr><td colspan="7"><center>暂无内容</center></td></tr>'}
      <tr align="center" onmousemove="javascript:this.bgColor='#fbfce2';" onmouseout="javascript:this.bgColor='#ffffff';">
        <td><input type="checkbox" name="logs" id="logs" value="{dede:field.lid/}"></td>
        <td>{dede:field.userid/}</td>
        <td><input type="text" value="{dede:field.filename/}" name="t0" class="biz-input-sm"></td>
        <td>{dede:field.method/}</td>
        <td>{dede:field.cip/}</td>
        <td>{dede:field.dtime function="MyDate('y/m/d H:i:s',@me)"/}</td>
        <td><input type="text" value="{dede:field.query/}" name="t1" class="biz-input-md"></td>
      </tr>
      {/dede:datalist}
    </form>
    <tr>
      <td colspan="7">
        <button type="button" onClick="ReSel();" class="btn btn-success btn-sm">反选</button>
        <button type="button" onClick="DelSel();" class="btn btn-danger btn-sm">删除</button>
        <button type="button" onClick="ClearLog();" class="btn btn-success btn-sm">清空所有日志</button>
      </td>
    </tr>
    <tr>
      <td bgcolor="#f8f8f8" class="py-2" colspan="7" align="center">{dede:pagelist listsize='6'/}</td>
    </tr>
  </table>
</body>
</html>