<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=<?php echo $cfg_soft_lang; ?>">
  <title>采集内容管理</title>
  <link rel="stylesheet" href="../static/web/css/bootstrap.min.css">
  <link rel="stylesheet" href="../static/web/font/css/font-awesome.min.css">
  <link rel="stylesheet" href="../static/web/css/admin.css">
  <script language="javascript">
    //获得选中文件的文件名
    function getCheckboxItem() {
      var allSel = "";
      if (document.form1.logs.value) return document.form1.logs.value;
      for (i = 0; i < document.form1.logs.length; i++) {
        if (document.form1.logs[i].checked) {
          if (allSel == "")
            allSel = document.form1.logs[i].value;
          else
            allSel = allSel + "`" + document.form1.logs[i].value;
        }
      }
      return allSel;
    }
    function ReSel() {
      for (i = 0; i < document.form1.logs.length; i++) {
        if (document.form1.logs[i].checked) document.form1.logs[i].checked = false;
        else document.form1.logs[i].checked = true;
      }
    }
    function DelSel() {
      var nid = getCheckboxItem();
      if (nid == "") {
        alert("请选择项目");
        return;
      }
      location.href = "log_edit.php?dopost=del&ids=" + nid;
    }
    function ClearLog() {
      location.href = "log_edit.php?dopost=clear";
    }
  </script>
</head>
<body background="../static/web/img/allbg.gif" leftmargin="8" topmargin="8">
  <table width="98%" border="0" cellpadding="2" cellspacing="1" align="center" class="table maintable table-bordered mt-3">
    <tr>
      <td height="26" colspan="7" background='../static/web/img/tbg.gif'>
        <table width="96%" border="0" cellpadding="0" cellspacing="0" class="table table-borderless">
          <tr>
            <td width="20%" height="18" style="padding-left:10px">管理系统日志</td>
            <td width="80%" align="right"></td>
          </tr>
        </table>
      </td>
    </tr>
    <tr align="center" bgcolor="#ffffff">
      <td colspan="7">
        <table width="100%" border="0" cellspacing="0" cellpadding="0" class="table-borderless">
          <form name='formsearch'>
            <tr>
              <td>
                管理员：
                <select name="adminid" id="adminid" style="width:160px">
                  <option value="0" selected>全部</option>
                  <?php echo $adminlist?>
                </select>
                IP地址：
                <input name="cip" type="text" id="cip" size="15" style="width:160px">
                时间：
                <select name="dtime" id="dtime" style="width:160px">
                  <option value="0" selected>全部</option>
                  <option value="7">一周内</option>
                  <option value="15">15天内</option>
                  <option value="30">30天以内</option>
                  <option value="60">60天以内</option>
                </select>
                &nbsp;
                <button type="submit" class="btn btn-success btn-sm">搜索</button>
              </td>
            </tr>
          </form>
        </table>
      </td>
    </tr>
    <tr align="center" bgcolor="#FBFCE2">
      <td width="8%">选择</td>
      <td width="11%">管理员</td>
      <td width="15%">访问文件</td>
      <td width="8%">方式</td>
      <td width="14%">访问IP</td>
      <td width="16%">时间</td>
      <td width="28%">Query参数</td>
    </tr>
    <form name="form1">
      {dede:datalist empty='<tr><td colspan="7"><center>暂无内容</center></td></tr>'}
      <tr align="center" bgcolor="#FFFFFF" height="26" align="center" onMouseMove="javascript:this.bgColor='#FCFDEE';" onMouseOut="javascript:this.bgColor='#FFFFFF';">
        <td>
          <input name='logs' type='checkbox' class='np' id="logs" value='{dede:field.lid/}' />
        </td>
        <td>
          {dede:field.userid/}
        </td>
        <td>
          <input class="np" type="text" value="{dede:field.filename/}" name="t0" style="width:100px">
        </td>
        <td>
          {dede:field.method/}
        </td>
        <td>
          {dede:field.cip/}
        </td>
        <td>
          {dede:field.dtime function="MyDate('y/m/d H:i:s',@me)" /}
        </td>
        <td>
          <input class="np" type="text" value="{dede:field.query/}" name="t1" style="width:280px">
        </td>
      </tr>
      {/dede:datalist}
    </form>
    <tr>
      <td height="30" colspan="7" bgcolor="#FCFDF7">
        <button type="button" onClick="ReSel();" class="btn btn-success btn-sm">反选</button>
        <button type="button" onClick="DelSel();" class="btn btn-success btn-sm">删除所选</button>
        <button type="button" onClick="ClearLog();" class="btn btn-success btn-sm">清空所有日志</button>
      </td>
    </tr>
    <tr bgcolor="#f8f8f8">
      <td height="26" colspan="7" align="center">
        {dede:pagelist listsize='5' /}
      </td>
    </tr>
  </table>
</body>
</html>