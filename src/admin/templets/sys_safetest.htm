<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <title><?php echo Lang('sys_safetest');?></title>
  <link rel="stylesheet" href="../static/web/css/bootstrap.min.css">
  <link rel="stylesheet" href="../static/web/font/css/font-awesome.min.css">
  <link rel="stylesheet" href="../static/web/css/admin.min.css">
  <script src="../static/web/js/jquery.min.js"></script>
  <script src="../static/web/js/webajax.js"></script>
  <script src="js/main.js"></script>
  <script>
    function LoadCtTest() {
      var filetype = $Obj('filetype').value;
      var info = $Obj('info').value;
      $Obj('loaddiv').style.display = 'block';
      fetch('sys_safetest.php?action=test&filetype=' + filetype + "&info=" + info).then(resp=>{
		    if (resp.ok) {
			   return resp.text()
		    }
		    throw new Error('<?php echo Lang("error_fetch");?>');
		  }).then((d)=>{
			  $DE('messagetd').innerHTML = d;
			  $Obj('loaddiv').style.display = 'none';
		  }).catch((error) => {
			  console.log(error);
		  });
    }
    function LoadCtClear() {
      $Obj('loaddiv').style.display = 'block';
      fetch('sys_safetest.php?action=clear').then(resp=>{
			  if (resp.ok) {
				  return resp.text()
			  }
			  throw new Error('<?php echo Lang("error_fetch");?>');
		  }).then((d)=>{
			  $DE('messagetd').innerHTML = d;
			  $Obj('loaddiv').style.display = 'none';
		  }).catch((error) => {
			  $DE('messagetd').innerHTML = errMsg;
		  });
    }
  </script>
</head>
<body>
  <div id="loaddiv" style="display:none">
    <p align="center" style="padding-top:160px"><img src="../static/web/img/load.gif" style="vertical-align:middle">请稍后，正在操作中</p>
  </div>
  <?php echo $alter;?>
  <table width="98%" align="center" cellpadding="1" cellspacing="1" class="table maintable mt-3 mb-3">
    <tr>
      <td bgcolor="#f8f8f8" colspan="2"><?php echo Lang('sys_safetest');?></td>
    </tr>
    <tr>
      <td colspan="2">
       <?php echo Lang('sys_safetest_tip');?>
      </td>
    </tr>
    <tr>
      <td colspan="2">
        <p><?php echo Lang('sys_safetest_filetype');?>：<input type="text" name="filetype" id="filetype" value="php|inc" style="width:390px"> <?php echo Lang('sys_safetest_filetype_tip');?></p>
        <p><?php echo Lang('sys_safetest_info');?>：<input type="text" name="info" id="info" value="eval|cmd|system|exec|_GET|_POST|_REQUEST|base64_decode" style="width:390px"> <?php echo Lang('sys_safetest_info_tip');?></p>
      </td>
    </tr>
    <tr>
      <td align="center" colspan="2" bgcolor="#f8fcf2" class="py-2">
        <button type="button" name="bt1" class="btn btn-success btn-sm" onclick="LoadCtTest();"><?php echo Lang('sys_safetest_test');?></button>
        <button type="button" name="bt2" class="btn btn-success btn-sm" onclick="LoadCtClear();"><?php echo Lang('sys_safetest_clear');?></button>
      </td>
    </tr>
    <tr>
      <td colspan="2"><?php echo Lang('sys_safetest_rs');?></td>
    </tr>
    <tr>
      <td height="360" colspan="2" id="messagetd" valign="top"></td>
    </tr>
  </table>
</body>
</html>