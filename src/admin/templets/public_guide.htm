<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=<?php echo $cfg_soft_lang; ?>">
<title>内容发布向导</title>
<link rel="stylesheet" href="../static/web/css/bootstrap.min.css">
<link rel="stylesheet" href="../static/web/font/css/font-awesome.min.css">
<link rel="stylesheet" href="../static/web/css/admin.css">
<script src="../static/web/js/jquery.min.js" language="javascript" type="text/javascript"></script>
<script src="../static/web/js/bootstrap.bundle.min.js"></script>
<script language="javascript" src="js/main.js"></script>
<style>
.np { border:0px }
</style>
<script language='javascript'>
	var selCheckbox = '';
	function ResetBox(selid)
	{
		var selobj = document.getElementById(selid);
		var preobj = null;
		if(selCheckbox!='') preobj = document.getElementById(selCheckbox);
		if(selobj.checked){
			if(preobj!=null && selid != selCheckbox) preobj.checked = false;
			selCheckbox = selid;
		} else {
			if(selCheckbox == selid) selCheckbox = '';
		}
	}
	function SetDefault()
	{
		if(selCheckbox==''){
			ShowMsg("您没有选中需要设置为默认的栏目");
		} else {
			var selobj = document.getElementById(selCheckbox);
			location="public_guide.php?action=setdefault&cid="+selobj.value;
		}
	}
	function ResetDefault(){
		location="public_guide.php?action=setdefault&cid=0";
	}
</script>
</head>
<body leftmargin="8" topmargin="8" background='../static/web/img/allbg.gif'>
<table width="98%" border="0" cellpadding="1" cellspacing="1" align="center" style="border:1px solid #dee2e6;" class="table maintable table-borderless mt-3">
  <tr align="center">
    <td height="120" align="left" valign="top" bgcolor="#ffffff">
	<table width="100%" border="0" cellspacing="0" cellpadding="6">
      <tr>
        <td>内容发布说明<br>
          1、必须先建立与频道内容模型关连的栏目才能发布内容（<a href="catalog_main.php">栏目管理</a>）<br>
          2、如果您设置了某频道为默认发布表单，以后将不再显示此向导，而是直接显示您所选的频道的发布表单，如果想要发布其它频道的内容，可以从左边的目录树中选择，如果以后您想要修改默认发布表单，请点击目录树上方的“发布向导”图标</td>
      </tr>
  </table>
	<table width="100%" border="0" cellpadding="3" cellspacing="1"  class="table table-bordered">
    <tr height="26" align="center" bgcolor="#FBFCE2">
        <td width="8%" >选择</td>
		    <td width="8%">频道ID</td>
        <td width="20%">频道内容模型</td>
        <td width="23%">附加表</td>
        <td width="10%">栏目数</td>
        <td>操作选项</td>
      </tr>
   <?php 
   $i=0;
   while($row = $dsql->GetArray()){
   $i++;
   $row['mancon'] = ($row['mancon']=='' ? 'content_list.php?channelid='.$row['id'] : $row['mancon'].'?channelid='.$row['id']);
   $checkbox = ($row['isdefault']==0 ? '' : ' checked');
   if($checkbox!=''){
   	 echo "<script language='javascript'>selCheckbox='cid{$i}';</script>\r\n";
   }
   $catnum = GetCatalogs($dsql,$row['id']);
   ?>   
     <tr align="center" bgcolor="#ffffff" height="26" onMouseMove="javascript:this.bgColor='#FCFDEE';" onMouseOut="javascript:this.bgColor='#ffffff';">
        <td><input type="checkbox" name="cid<?php echo $i; ?>" id="cid<?php echo $i; ?>" onClick="ResetBox('cid<?php echo $i; ?>')" value="<?php echo $row['id']; ?>" class="np" <?php echo $checkbox; ?>/></td>
		    <td><?php echo $row['id']; ?></td>
        <td><?php echo $row['typename']; ?></td>
        <td><?php echo $row['addtable']; ?></td>
        <td><?php echo $catnum; ?></td>
        <td>
        <a href="catalog_main.php" class="btn btn-success btn-sm">管理栏目</a>
        <?php
        if($catnum>0){
        ?>
        <a href="<?php echo $row['mancon']; ?>" class="btn btn-success btn-sm">管理内容</a>
        <a href="catalog_do.php?channelid=<?php echo $row['id']; ?>&cid=0&dopost=addArchives" class="btn btn-success btn-sm">发布内容</a>
       <?php } else { ?>
       		 | 
        <span>管理内容</span>
        	 | 
        <span>发布内容</span>
       <?php } ?>
        </td>
      </tr>
    <?php
    }
    ?>
    </table>
    <table width="100%" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td>
        	<button name="b1" type="button" id="b1" onClick="SetDefault()" class="btn btn-success btn-sm">把所选的频道表单设为默认表单</button>
        	<button name="b2" type="button" id="b2" onClick="ResetDefault()" class="btn btn-success btn-sm">取消默认表单</button>
        </td>
      </tr>
    </table>
  </td>
  </tr>
</table>
</body>
</html>