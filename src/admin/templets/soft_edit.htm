<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
		<title>修改软件模型</title>
		<link rel="stylesheet" href="../static/web/font/css/font-awesome.min.css">
		<link rel="stylesheet" href="../static/web/css/bootstrap.min.css">
		<link rel="stylesheet" href="../static/web/css/admin.css">
		<link rel="stylesheet" href="../static/web/css/daterangepicker.css">
		<link rel="stylesheet" href="../static/web/css/cropper.min.css">
		<script>const cfg_uplitpic_cut = '<?php echo $cfg_uplitpic_cut;?>';</script>
		<script src="../static/web/js/jquery.min.js"></script>
		<script src="../static/web/js/bootstrap.min.js"></script>
		<script src="../static/web/js/webajax.js"></script>
		<script src="../static/web/js/moment.min.js"></script>
		<script src="../static/web/js/daterangepicker.js"></script>
		<script src="js/main.js"></script>
		<script src="../static/web/js/cropper.min.js"></script>
		<script>
			function checkSubmit() {
				if (document.form1.title.value == "") {
					ShowMsg("请输入文档标题");
					document.form1.title.focus();
					return false;
				}
			}
			var startNum = <?php echo $newRowStart?>;
			function MakeUpload() {
				var upfield = document.getElementById('uploadfield');
				var endNum = parseInt(document.form1.picnum.value) + startNum;
				if (endNum > 30) endNum = 30;
				for (startNum; startNum < endNum; startNum++) {
					upfield.innerHTML += "<div class='py-2'>软件地址" + startNum + "：<input type='text' name='softurl" + startNum + "' value='http://' class='admin-input-md'> 服务器名称：<input type='text' name='servermsg" + startNum + "' class='admin-input-sm'></div>";
				}
			}
			function ShowHideAddr() {
				document.getElementById('morelink').style.display = (document.getElementById('morelink').style.display == 'block' ? 'none' : 'block');
				document.getElementById('btsh3').value = (document.getElementById('morelink').style.display == 'block' ? '隐藏地址' : '显示地址');
			}
		</script>
	</head>
	<body>
		<form name="form1" action="soft_edit.php" enctype="multipart/form-data" method="post" onSubmit="return checkSubmit();">
			<input type="hidden" name="dopost" value="save">
			<input type="hidden" name="channelid" value="<?php echo $channelid?>">
			<input type="hidden" name="id" value="<?php echo $aid?>">
			<table width="98%" align="center" cellpadding="2" cellspacing="2" id="needset" class="admin-border my-3">
				<tr bgcolor="#f5f5f5">
					<td class="admin-td">修改软件文档</td>
				</tr>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">文档标题：</td>
								<td width="400"><input type="text" name="title" id="title" value="<?php echo $arcRow['title'];?>" class="admin-input-lg"></td>
								<td width="90">简略标题：</td>
								<td><input type="text" name="shorttitle" id="shorttitle" value="<?php echo $arcRow['shorttitle'];?>" class="admin-input-sm"></td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">自定义属性：</td>
								<td>
									<?php
									$dsql->SetQuery("SELECT * FROM `#@__arcatt` ORDER BY sortid ASC");
									$dsql->Execute();
									while($trow = $dsql->GetObject())
									{
										if ($trow->att=='j') $jumpclick = " onclick='ShowUrlTr()'";
										else $jumpclick = '';
										if (preg_match("#".$trow->att."#",$arcRow['flag']))
											echo "<label class='mr-2'><input type='checkbox' name='flags[]' id='flags{$trow->att}' value='{$trow->att}' {$jumpclick} checked='checked'> {$trow->attname}[{$trow->att}]</label>";
										else
											echo "<label class='mr-2'><input type='checkbox' name='flags[]' id='flags{$trow->att}' value='{$trow->att}'{$jumpclick} /> {$trow->attname}[{$trow->att}]</label>";
									}
									?>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="admin-td" id="redirecturltr"
					 style="display:<?php echo (empty($addRow['redirecturl']) ? 'none' : 'block');?>">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">跳转网址：</td>
								<td><input type="text" name="redirecturl" id="redirecturl" value="<?php echo $addRow['redirecturl']?>" class="admin-input-md"></td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">标签：</td>
								<td><input type="text" name="tags" id="tags" value="<?php echo $tags;?>" class="admin-input-md">（英文逗号分开，如“DedeBIZ,得德”）</td>
								<td width="60">权重：</td>
								<td><input type="text" name="weight" id="weight" value="<?php echo $arcRow['weight'];?>" class="admin-input-sm">（越小越靠前）</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr id="pictable">
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">缩略图：</td>
								<td width="620">
									<input type="text" name="picname" id="picname" value="<?php echo $arcRow['litpic']?>" class="admin-input-md">
									<label><input type="checkbox" name="ddisremote" value="1" id="ddisremote" class="l-height-28"> 远程</label>
									<span class="btn btn-success btn-sm fileinput-button">上传图片<input type="file" name="files[]" id="iptAddImages"></span>
									<button type="button" name="Submit" onclick="SelectImage('form1.picname','');" class="btn btn-success btn-sm">选择图片</button>
									<button type="button" id="btnClearAll" class="btn btn-success btn-sm">清空</button>
								</td>
								<td><img src="<?php if ($arcRow['litpic']!='') echo $arcRow['litpic']; else echo '../static/web/img/thumbnail.jpg';?>" id="litPic" class="thumbnail-md"></td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">来源：</td>
								<td width="260">
									<input type="text" name="source" id="source" value="<?php echo $arcRow['source']?>" class="admin-input-sm">
									<button type="button" name="selsource" id="selsource" class="btn btn-success btn-sm">选择</button>
								</td>
								<td width="60">作者：</td>
								<td>
									<input type="text" name="writer" id="writer" value="<?php echo $arcRow['writer']?>" class="admin-input-sm">
									<button type="button" name="selwriter" id="selwriter" class="btn btn-success btn-sm">选择</button>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">发布栏目：</td>
								<td width="360">
									<?php
									$typeOptions = GetOptionList($arcRow["typeid"],$cuserLogin->getUserChannel(),$channelid);
									echo "<select name='typeid' id='typeid' class='admin-input-sm'>";
									if ($arcRow["typeid"]=="0") echo "<option value='0' selected>请选择主分类</option>";
									echo $typeOptions;
									echo "</select>";
									?>
									<i class="btn btn-sm fa fa-search" onclick="ShowCatMap(event,this,<?php echo $channelid;?>,'typeid','<?php echo $arcRow['typeid'];?>')" title="快捷选择"></i>
								</td>
								<td width="90">需要金币：</td>
								<td><input type="text" name="needmoney" id="needmoney" value="<?php echo $needmoney;?>" class="admin-input-sm"></td>
							</tr>
						</table>
					</td>
				</tr>
				<?php if ($cfg_need_typeid2=='Y') {?>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">副栏目：</td>
								<td>
									<span id="typeid2ct"></span>
									<input type="text" name="typeid2" id="typeid2" value="<?php echo ($arcRow['typeid2']=='0' ? '' : $arcRow['typeid2']);?>" class="admin-input-sm">
									<i class="btn btn-sm fa fa-search" onclick="ShowCatMap(event,this,<?php echo $channelid;?>,'typeid2','<?php echo $arcRow['typeid2'];?>')" title="选择副栏目"></i>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<?php }?>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">关键词：</td>
								<td><input type="text" name="keywords" id="keywords" value="<?php echo $arcRow['keywords']?>" class="admin-input-md"></td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">描述：</td>
								<td><textarea name="description" id="description" class="admin-textarea-sm"><?php echo $arcRow['description']?></textarea></td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">文件类型：</td>
								<td width="170">
									<select name="filetype" id="filetype" class="admin-input-sm">
										<?php
										if ($addRow["filetype"]!="") echo "<option value=\"".$addRow["filetype"]."\">".$addRow['filetype']."</option>";
										?>
										<option value=".exe">.exe</option>
										<option value=".zip">.zip</option>
										<option value=".rar">.rar</option>
										<option value=".iso">.iso</option>
										<option value=".gz">.gz</option>
										<option value="其它">其它</option>
									</select>
								</td>
								<td width="90">软件等级：</td>
								<td width="170">
									<select name="softrank" id="softrank" class="admin-input-sm">
										<?php
										if ($addRow["softrank"]!="") echo "<option value=\"".$addRow["softrank"]."\">".$addRow['softrank']."星</option>";
										?>
										<option value="1">一星</option>
										<option value="2">二星</option>
										<option value="3">三星 </option>
										<option value="4">四星</option>
										<option value="5">五星</option>
									</select>
								</td>
								<td width="90">软件类型：</td>
								<td width="170">
									<select name="softtype" id="softtype" class="admin-input-sm">
										<?php
										if ($addRow["softtype"]!="") echo "<option value=\"".$addRow["softtype"]."\">".$addRow['softtype']."</option>";
										?>
										<option value="国产软件">国产软件</option>
										<option value="国外软件">国外软件</option>
										<option value="汉化补丁">汉化补丁</option>
									</select>
								</td>
								<td width="90">界面语言：</td>
								<td width="170">
									<select name="language" id="language" class="admin-input-sm">
										<?php
										if ($addRow["language"]!="") echo "<option value=\"".$addRow["language"]."\">".$addRow['language']."</option>";
										?>
										<option value="简体中文">简体中文</option>
										<option value="英文软件">英文软件</option>
										<option value="繁体中文">繁体中文</option>
										<option value="其它类型">其它类型</option>
									</select>
								</td>
								<td width="90">授权方式：</td>
								<td width="170">
									<select name="accredit" id="accredit" class="admin-input-sm">
										<?php
										if ($addRow["accredit"]!="") echo "<option value=\"".$addRow["accredit"]."\">".$addRow['accredit']."</option>";
										?>
										<option value="共享软件">共享软件</option>
										<option value="免费软件">免费软件</option>
										<option value="开源软件">开源软件</option>
										<option value="商业软件">商业软件</option>
										<option value="破解软件">破解软件</option>
										<option value="游戏外挂">游戏外挂</option>
									</select>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">运行环境：</td>
								<td><input type="text" name="os" value="<?php echo $addRow['os']?>" class="admin-input-md"></td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">官方网址：</td>
								<td width="370"><input type="text" name="officialUrl" id="officialUrl" value="<?php echo $addRow['officialUrl']?>" class="admin-input-md"></td>
								<td width="90">程序演示：</td>
								<td><input type="text" name="officialDemo" id="officialDemo" value="<?php echo $addRow['officialDemo']?>" class="admin-input-md"></td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">软件大小：</td>
								<td width="370"><input name="softsize" type="text" id="softsize" value="<?php echo $addRow['softsize']?>" class="admin-input-md"></td>
								<td width="90">需会员权限：</td>
								<td>
									<select name="daccess" id="daccess" class="admin-input-sm">
										<?php
										$dsql->SetQuery("SELECT * FROM `#@__arcrank` where `rank`>=0 ");
										$dsql->Execute();
										while($row = $dsql->GetArray())
										{
											if ($row['rank']==0) $row['membername'] = "不限会员";
											if ($row['rank'] == $daccess) echo "<option value='{$row['rank']}' selected>{$row['membername']}</option>";
											else echo "<option value='{$row['rank']}'>{$row['membername']}</option>";
										}
										?>
									</select>
									<a href="soft_config.php" class="btn btn-success btn-sm">软件下载设置</a>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<?php PrintAutoFieldsEdit(stripslashes($cInfos['fieldset']),$addRow,'autofield');?>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">其它地址：</td>
								<td>
									<input type="text" name="picnum" id="picnum" size="8" value="5">
									<button type="button" name="kkkup" id="kkkup2" class="btn btn-success btn-sm" onclick="MakeUpload();">添加数量</button>
									<button type="button" name="Submit3" id="btsh3" class="btn btn-success btn-sm" onclick="ShowHideAddr();">隐藏地址</button>（最多为30个链接）
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="admin-td">
						<?php echo $nForm;?>
						<div id="morelink" style="display:block">
							<div id="uploadfield"></div>
						</div>
					</td>
				</tr>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">附加选项：</td>
								<td>
									<label><input type="checkbox" name="remote" id="remote" value="1" <?php if ($cfg_rm_remote=='Y') echo 'checked="1"';?>> 下载远程图片和资源</label>
									<label><input type="checkbox" name="autolitpic" id="autolitpic" value="1" <?php if ($cfg_arc_autopic=='Y') echo 'checked="1"';?>> 提取第一个图片为缩略图</label>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="admin-td"><?php GetEditor("body",$addRow["introduce"],400,"Small");?></td>
				</tr>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90" width="260">评论选项：</td>
								<td width="260">
									<label><input type="radio" name="notpost" value="0" <?php if ($arcRow['notpost']==0) echo "checked='1'";?>> 允许评论</label>
									<label><input type="radio" name="notpost" value="1" <?php if ($arcRow['notpost']==1) echo "checked='1'";?>> 禁止评论</label>
								</td>
								<td width="90">发布选项：</td>
								<td>
									<label><input type="radio" name="ishtml" value="1" <?php if ($arcRow["ismake"]!=-1) echo "checked";?>> 生成网页</label>
									<label><input type="radio" name="ishtml" value="0" <?php if ($arcRow["ismake"]==-1) echo "checked";?>> 仅动态浏览</label>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">文档排序：</td>
								<td width="260">
									<select name="sortup" id="sortup" class="admin-input-sm">
										<?php
										$subday = SubDay($arcRow["sortrank"],$arcRow["pubdate"]);
										echo "<option value='0'>正常排序</option>";
										if ($subday>0) echo "<option value='$subday' selected>置顶<span class='text-primary'>$subday</span>天</option>";
										?>
										<option value="7">置顶一周</option>
										<option value="30">置顶一个月</option>
										<option value="90">置顶三个月</option>
										<option value="180">置顶半年</option>
										<option value="360">置顶一年</option>
									</select>
								</td>
								<td width="90">标题颜色：</td>
								<td>
									<input type="text" name="color" id="color" value="<?php echo $arcRow['color']?>" class="admin-input-sm">
									<button class='btn btn-success btn-sm' name="modcolor" type="button" id="modcolor" onclick="ShowColor(event,this)">选取</button>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">阅读权限：</td>
								<td width="260">
									<select name="arcrank" id="arcrank" class="admin-input-sm">
										<option value='<?php echo $arcRow["arcrank"];?>'>
											<?php echo ($arcRow["arcrank"]==0 ? '已审核状态' : $arcRow["rankname"]);?>
										</option>
										<option value='0'>已审核状态</option>
										<option value='-1'>未审核状态</option>
									</select>
								</td>
								<td width="90">文件名称：</td>
								<td><input type="text" name="filename" id="filename" value="<?php echo $arcRow['filename']?>" class="admin-input-sm">（不包括后缀名如.html等）
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td height="70" class="admin-td">
						<table cellspacing="0" cellpadding="0">
							<tr>
								<td width="90">更新时间：</td>
								<td width="260">
									<?php
									$nowtime = GetDateTimeMk($arcRow["pubdate"]);
									echo "<input type='text' name='pubdate' value='$nowtime' id='pubdate' class='datepicker admin-input-sm'>";
									?>
								</td>
								<td width="90">浏览次数：</td>
								<td><input type="text" name="click" value="<?php echo $arcRow['click'];?>" class="admin-input-sm"></td>
							</tr>
						</table>
					</td>
				</tr>
				<tr bgcolor="#f5f5f5">
					<td align="center" class="admin-td">
						<button type="submit" class="btn btn-success btn-sm">保存</button>
						<button type="button" class="btn btn-outline-success btn-sm" onclick="location.reload();">重置</button>
					</td>
				</tr>
			</table>
		</form>
		<script>InitPage();</script>
	</body>
</html>