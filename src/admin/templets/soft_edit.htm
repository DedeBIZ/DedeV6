<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <title><?php echo Lang('archives_edit');?></title>
  <link rel="stylesheet" href="../static/web/css/bootstrap.min.css">
  <link rel="stylesheet" href="../static/web/font/css/font-awesome.min.css">
  <link rel="stylesheet" href="../static/web/css/admin.min.css">
  <link rel="stylesheet" href="../static/web/css/daterangepicker.css">
  <link rel="stylesheet" href="../static/web/css/jquery.fileupload.css">
  <link rel="stylesheet" href="../static/web/css/cropper.min.css">
  <script>const cfg_uplitpic_cut = '<?php echo $cfg_uplitpic_cut;?>';</script>
  <?php include_once(DEDEADMIN.'/templets/_widget_lang.htm');?>
  <script src="../static/web/js/jquery.min.js"></script>
  <script src="../static/web/js/bootstrap.bundle.min.js"></script>
  <script src="../static/web/js/webajax.js"></script>
  <script src="../static/web/js/moment.min.js"></script>
  <script src="../static/web/js/daterangepicker.js"></script>
  <script src="js/main.js"></script>
  <script src="../static/web/js/cropper.min.js"></script>
  <style>
  table{border-collapse:separate}
  .style1 {color:#555}
  </style>
  <script>
    function checkSubmit() {
      if (document.form1.title.value == '') {
        ShowMsg('<?php echo Lang("err_title_isempty");?>');
        document.form1.title.focus();
        return false;
      }
    }
    var startNum = <?php echo $newRowStart?>;
    function MakeUpload() {
      var upfield = document.getElementById('uploadfield');
      var endNum = parseInt(document.form1.picnum.value) + startNum;
      if (endNum > 30) endNum = 30;
      for (startNum; startNum < endNum; startNum++) {
        upfield.innerHTML += "<div class='mt-1 mb-1'><?php echo Lang('soft_softurl_n');?>" + startNum + "：<input type='text' name='softurl" + startNum + "' value='http://' style='width:260px'> <?php echo Lang('soft_servermsg1');?>：<input type='text' name='servermsg" + startNum + "' style='width:160px'></div>";
      }
    }
    function ShowHideAddr() {
      document.getElementById('morelink').style.display = (document.getElementById('morelink').style.display == 'block' ? 'none' : 'block');
      document.getElementById('btsh3').value = (document.getElementById('morelink').style.display == 'block' ? '<?php echo Lang("soft_morelink_1");?>' : '<?php echo Lang("soft_morelink_0");?>');
    }
  </script>
</head>
<body>
  <form name="form1" action="soft_edit.php" enctype="multipart/form-data" method="post" onSubmit="return checkSubmit();">
    <input type="hidden" name="dopost" value="save">
    <input type="hidden" name="channelid" value="<?php echo $channelid?>">
    <input type="hidden" name="id" value="<?php echo $aid?>">
    <table width="98%" align="center" cellpadding="0" cellspacing="0" class="mt-3 mb-3">
      <tr>
        <td width="70%"><i class="fa fa-map-marker"></i> <a href="catalog_do.php?cid=<?php echo $arcRow['typeid']?>&dopost=listArchives"></a><a href="catalog_do.php?cid=<?php echo $arcRow['typeid']?>&dopost=listArchives"><?php echo Lang('content_list2');?></a> &gt; <?php echo Lang('archives_edit');?></td>
        <td align="right">  <a href="catalog_main.php" class="btn btn-success btn-sm"><?php echo Lang('catalog_main');?></a></td>
      </tr>
    </table>
    <table width="98%" align="center" cellpadding="2" cellspacing="2" class="biz-border">
      <tr>
        <td colspan="4" class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('title');?>：</td>
              <td width="400"><input type="text" name="title" id="title" value="<?php echo $arcRow['title'];?>" style="width:390px"></td>
              <td width="90"><?php echo Lang('content_short_title');?>：</td>
              <td><input type="text" name="shorttitle" id="shorttitle" value="<?php echo $arcRow['shorttitle'];?>" style="width:160px"></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td colspan="4" class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('content_flags');?>：</td>
              <td>
              <?php
		          $dsql->SetQuery("SELECT * FROM `#@__arcatt` ORDER BY sortid ASC");
		          $dsql->Execute();
		          while($trow = $dsql->GetObject())
		          {
		    	      if ($trow->att=='j') $jumpclick = " onclick='ShowUrlTr()'";
		    	      else $jumpclick = '';
		    	      if (preg_match("#".$trow->att."#",$arcRow['flag']))
		    	      echo "<label class='mr-1'><input type='checkbox' name='flags[]' id='flags{$trow->att}' value='{$trow->att}' {$jumpclick} checked='checked'> {$trow->attname}[{$trow->att}]</label>";
                else
                echo "<label class='mr-1'><input type='checkbox' name='flags[]' id='flags{$trow->att}' value='{$trow->att}'{$jumpclick} /> {$trow->attname}[{$trow->att}]</label>";
              }
              ?>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td colspan="4" class="bline" id="redirecturltr" style="display:<?php echo (empty($addRow['redirecturl']) ? 'none' : 'block');?>">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('content_redirecturl');?>：</td>
              <td><input type="text" name="redirecturl" id="redirecturl" value="<?php echo $addRow['redirecturl']?>" style="width:300px"></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('content_tags');?>：</td>
              <td><input type="text" name="tags" id="tags" value="<?php echo $tags;?>" style="width:300px"><?php echo Lang('content_tags_tip');?></td>
              <td width="60"><?php echo Lang('content_weight');?>：</td>
              <td><input type="text" name="weight" id="weight" value="<?php echo $arcRow['weight'];?>" style="width:60px"><?php echo Lang('content_weight_tip');?></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr id="pictable">
        <td colspan="4" class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90" height="80"> <?php echo Lang('litpic');?>：</td>
              <td width="560">
                <input type="text" name="picname" id="picname" value="<?php echo $arcRow['litpic']?>" style="width:300px">
                <label><input type="checkbox" name="ddisremote" value="1" id="ddisremote"> <?php echo Lang('remote');?></label>
                <span class="btn btn-success btn-sm fileinput-button"><?php echo Lang('upload');?><input type="file" name="files[]" id="iptAddImages"></span>
                <button type="button" name="Submit" onClick="SelectImage('form1.picname','');" class="btn btn-success btn-sm"><?php echo Lang('select');?></button>
                <button type="button" id="btnClearAll" class="btn btn-success btn-sm delete"><?php echo Lang('clear');?></button>
              </td>
              <td align="center"><img src="<?php if ($arcRow['litpic']!='') echo $arcRow['litpic']; else echo '../static/web/img/thumbnail.jpg';?>" id="litPic" class="thumbnail"></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td colspan="4" class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('source');?>：</td>
              <td width="260">
                <input type="text" name="source" id="source"value="<?php echo $arcRow['source']?>" style="width:160px">
                <button type="button" name="selsource" id="selsource" class="btn btn-success btn-sm"><?php echo Lang('select');?></button>
              </td>
              <td width="60"> <?php echo Lang('writer');?>：</td>
              <td>
                <input type="text" name="writer" id="writer" value="<?php echo $arcRow['writer']?>" style="width:160px">
                <button type="button" name="selwriter" id="selwriter" class="btn btn-success btn-sm"><?php echo Lang('select');?></button>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td colspan="4" class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('content_typeid');?>：</td>
              <td width="360">
                <?php
                $typeOptions = GetOptionList($arcRow["typeid"],$cUserLogin->getUserChannel(),$channelid);
                echo "<select name='typeid' id='typeid' style='width:160px'>";
                if ($arcRow["typeid"]=="0") echo "<option value='0' selected>".Lang('catalog_select')."</option>";
                echo $typeOptions;
                echo "</select>";
			          ?>
                <i class="btn btn-sm fa fa-search" onClick="ShowCatMap(event,this,<?php echo $channelid;?>,'typeid','<?php echo $arcRow['typeid'];?>')" title="<?php echo Lang('quick_selection');?>" style="cursor:pointer"></i>
              </td>
              <td width="90"><?php echo Lang('content_money');?>：</td>
              <td><input type="text" name="needmoney" id="needmoney" value="<?php echo $needmoney;?>" style="width:160px"></td>
            </tr>
          </table>
        </td>
      </tr>
      <?php if ($cfg_need_typeid2=='Y') {?>
      <tr>
        <td class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('typeid2');?>：</td>
              <td>
                <span id="typeid2ct"></span>
                <input type="text" name="typeid2" id="typeid2" value="<?php echo ($arcRow['typeid2']=='0' ? '' : $arcRow['typeid2']);?>" style="width:160px">
                <i class="btn btn-sm fa fa-search" onClick="ShowCatMap(event,this,<?php echo $channelid;?>,'typeid2','<?php echo $arcRow['typeid2'];?>')" title="<?php echo Lang('content_select_typeid2');?>" style="cursor:pointer"></i></td>
            </tr>
          </table>
        </td>
      </tr>
      <?php }?>
      <tr>
        <td class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('keywords');?>：</td>
              <td><input type="text" name="keywords" id="keywords" value="<?php echo $arcRow['keywords']?>" style="width:360px"></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('description');?>：</td>
              <td><textarea name="description" id="description" style="width:360px;height:50px"><?php echo $arcRow['description']?></textarea></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td colspan="4" class="bline">
          <table width="1300" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('sys_safetest_filetype');?>：</td>
              <td width="170">
                <select name="filetype" id="filetype" style="width:160px">
                  <?php
                  if ($addRow["filetype"]!="") echo "<option value=\"".$addRow["filetype"]."\">".$addRow['filetype']."</option>";
                  ?>
                  <option value=".exe">.exe</option>
                  <option value=".zip">.zip</option>
                  <option value=".rar">.rar</option>
                  <option value=".iso">.iso</option>
                  <option value=".gz">.gz</option>
                  <option value="<?php echo Lang('other');?>"><?php echo Lang('other');?></option>
                </select></td>
              <td width="90"><?php echo Lang('soft_softrank');?>：</td>
              <td width="170">
                <select name="softrank" id="softrank" style="width:160px">
                  <?php
                  if ($addRow["softrank"]!="") echo "<option value=\"".$addRow["softrank"]."\">".$addRow['softrank']."星</option>";
                  ?>
                  <option value="1"><?php echo Lang('soft_softrank_1');?></option>
                  <option value="2"><?php echo Lang('soft_softrank_2');?></option>
                  <option value="3"><?php echo Lang('soft_softrank_3');?> </option>
                  <option value="4"><?php echo Lang('soft_softrank_4');?></option>
                  <option value="5"><?php echo Lang('soft_softrank_5');?></option>
                </select>
              </td>
              <td width="90"><?php echo Lang('soft_softtype');?>：</td>
              <td width="170">
                <select name="softtype" id="softtype" style="width:160px">
                  <?php
                  if ($addRow["softtype"]!="") echo "<option value=\"".$addRow["softtype"]."\">".$addRow['softtype']."</option>";
                  ?>
                  <option value="<?php echo Lang('soft_softtype_1');?>"><?php echo Lang('soft_softtype_1');?></option>
                  <option value="<?php echo Lang('soft_softtype_2');?>"><?php echo Lang('soft_softtype_2');?></option>
                  <option value="<?php echo Lang('soft_softtype_3');?>"><?php echo Lang('soft_softtype_3');?></option>
                </select>
              </td>
              <td width="90"><?php echo Lang('soft_language');?>：</td>
              <td width="170">
                <select name="language" id="language" style="width:160px">
                  <?php
                  if ($addRow["language"]!="") echo "<option value=\"".$addRow["language"]."\">".$addRow['language']."</option>";
                  ?>
                  <option value="<?php echo Lang('soft_language_1');?>"><?php echo Lang('soft_language_1');?></option>
                  <option value="<?php echo Lang('soft_language_2');?>"><?php echo Lang('soft_language_2');?></option>
                  <option value="<?php echo Lang('soft_language_3');?>"><?php echo Lang('soft_language_3');?></option>
                  <option value="<?php echo Lang('soft_language_4');?>"><?php echo Lang('soft_language_4');?></option>
                </select>
              </td>
              <td width="90"><?php echo Lang('soft_accredit');?>：</td>
              <td width="170">
                <select name="accredit" id="accredit" style="width:160px">
                  <?php
                  if ($addRow["accredit"]!="") echo "<option value=\"".$addRow["accredit"]."\">".$addRow['accredit']."</option>";
                  ?>
                  <option value="<?php echo Lang('soft_accredit_1');?>"><?php echo Lang('soft_accredit_1');?></option>
                  <option value="<?php echo Lang('soft_accredit_2');?>"><?php echo Lang('soft_accredit_2');?></option>
                  <option value="<?php echo Lang('soft_accredit_3');?>"><?php echo Lang('soft_accredit_3');?></option>
                  <option value="<?php echo Lang('soft_accredit_4');?>"><?php echo Lang('soft_accredit_4');?></option>
                  <option value="<?php echo Lang('soft_accredit_5');?>"><?php echo Lang('soft_accredit_5');?></option>
                  <option value="<?php echo Lang('soft_accredit_6');?>"><?php echo Lang('soft_accredit_6');?></option>
                </select>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td colspan="4" class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('soft_os');?>：</td>
              <td><input type="text" name="os" value="<?php echo $addRow['os']?>" style="width:260px"></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td colspan="4" class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('soft_official_url');?>：</td>
              <td width="310"><input type="text" name="officialUrl" id="officialUrl" value="<?php echo $addRow['officialUrl']?>" style="width:260px"></td>
              <td width="90"><?php echo Lang('soft_official_demo');?>：</td>
              <td><input type="text" name="officialDemo" id="officialDemo" value="<?php echo $addRow['officialDemo']?>" style="width:260px"></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td colspan="4" class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('soft_softsize');?>：</td>
              <td><input name="softsize" type="text" id="softsize" value="<?php echo $addRow['softsize']?>" style="width:60px"></td>
              <td width="90"><?php echo Lang('soft_daccess');?>：</td>
              <td>
                <select name="daccess" id="daccess" style="width:160px">
                <?php
                $dsql->SetQuery("SELECT * FROM `#@__arcrank` WHERE `rank`>=0");
                $dsql->Execute();
                while($row = $dsql->GetArray())
                {
                  if ($row['rank']==0) $row['membername'] = "不限会员";
                  if ($row['rank'] == $daccess) echo "<option value='{$row['rank']}' selected>{$row['membername']}</option>";
                  else echo "<option value='{$row['rank']}'>{$row['membername']}</option>";
                }
                ?>
                </select>
                <a href="soft_config.php" class="btn btn-success btn-sm"><?php echo Lang('soft_config');?></a>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td><?php PrintAutoFieldsEdit(stripslashes($cInfos['fieldset']),$addRow,'autofield');?></td>
      </tr>
      <tr>
        <td colspan="4" class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('soft_other');?>：</td>
              <td>
                <input type="text" name="picnum" id="picnum" size="8" value="5">
                <button type="button" name="kkkup" id="kkkup2" class="btn btn-success btn-sm" onClick="MakeUpload();"><?php echo Lang('soft_other_add');?></button>
                <button type="button" name="Submit3" id="btsh3" class="btn btn-success btn-sm" onClick="ShowHideAddr();"><?php echo Lang('soft_other_hide');?></button>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td colspan="4" class="bline">
          <?php echo $nForm;?>
          <div id="morelink">
            <div id="uploadfield"></div>
          </div>
        </td>
      </tr>
      <tr>
        <td colspan="4" class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('addon_options');?>：</td>
              <td>
                <label><input type="checkbox" name="remote" id="remote" value="1" <?php if ($cfg_rm_remote=='Y') echo 'checked="1"';?>> <?php echo Lang('addon_options_remote');?></label>
                <label><input type="checkbox" name="autolitpic" id="autolitpic" value="1" <?php if ($cfg_arc_autopic=='Y') echo 'checked="1"';?>> <?php echo Lang('addon_options_autolitpic');?></label>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td colspan="4" class="bline"><?php GetEditor("body",$addRow["introduce"],450,"Small");?></td>
      </tr>
      <tr>
        <td colspan="4" class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"  width="260"> <?php echo Lang('comment_options');?>：</td>
              <td width="260">
                <label><input type='radio' name='notpost' value='0' <?php if ($arcRow['notpost']==0) echo 'checked="1"';?>> <?php echo Lang('enable');?></label>
                <label><input type='radio' name='notpost' value='1' <?php if ($arcRow['notpost']==1) echo 'checked="1"';?>> <?php echo Lang('disable');?></label>
              </td>
              <td width="90"><?php echo Lang('publish_options');?>：</td>
              <td>
                <label><input type="radio" name="ishtml" value="1" <?php if ($arcRow["ismake"]!=-1) echo "checked";?>> <?php echo Lang('content_ishtml_1');?></label>
                <label><input type="radio" name="ishtml" value="0" <?php if ($arcRow["ismake"]==-1) echo "checked";?>> <?php echo Lang('content_ishtml_0');?></label>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('content_sortup');?>：</td>
              <td width="260">
                <select name="sortup" id="sortup" style="width:160px">
                <?php
                $subday = SubDay($arcRow["sortrank"],$arcRow["pubdate"]);
                echo "<option value='0'>".Lang('default')."</option>";
                if ($subday>0) echo "<option value='$subday' selected>".Lang('content_ontop_day',array('subday'=>$subday))."</option>";
                ?>
                  <option value="7"><?php echo Lang('content_sortup_7');?></option>
                  <option value="30"><?php echo Lang('content_sortup_30');?></option>
                  <option value="90"><?php echo Lang('content_sortup_90');?></option>
                  <option value="180"><?php echo Lang('content_sortup_180');?></option>
                  <option value="360"><?php echo Lang('content_sortup_360');?></option>
                </select> </td>
              <td width="90"><?php echo Lang('content_title_color');?>：</td>
              <td>
                <input type="text" name="color" id="color" value="<?php echo $arcRow['color']?>" style="width:160px">
                <button class='btn btn-success btn-sm' name="modcolor" type="button" id="modcolor" onClick="ShowColor(event,this)"><?php echo Lang('select');?></button>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('content_arcrank');?>：</td>
              <td width="260">
                <select name="arcrank" id="arcrank" style="width:160px">
                  <option value='<?php echo $arcRow["arcrank"];?>'><?php echo ($arcRow["arcrank"]==0 ? Lang('soft_arcrank_0') : $arcRow["rankname"]);?></option>
                  <option value='0'><?php echo Lang('soft_arcrank_0');?></option>
                  <option value='-1'><?php echo Lang('soft_arcrank_1');?></option>
                </select>
              </td>
              <td width="90"><?php echo Lang('content_filename');?>：</td>
              <td><input type="text" name="filename" id="filename" value="<?php echo $arcRow['filename']?>" style="width:160px"><?php echo Lang('content_filename_tip');?></td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td height="70" class="bline">
          <table width="900" cellspacing="0" cellpadding="0">
            <tr>
              <td width="90"><?php echo Lang('content_pubdate');?>：</td>
              <td width="260">
              <?php
              $nowtime = GetDateTimeMk($arcRow["pubdate"]);
              echo "<input type='text' name='pubdate' value='$nowtime' id='pubdate' class='datepicker' style='width:160px'>";
              ?>
              </td>
              <td width="90"><?php echo Lang('click');?>：</td>
              <td><input type="text" name="click" value="<?php echo $arcRow['click'];?>" style="width:160px"></td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
    <table width="98%" align="center" cellspacing="0" cellpadding="0" bgcolor="#f8f8f8" class="mb-3 biz-border border-top-0">
      <tr>
        <td align="center" class="py-2">
          <button type="submit" class="btn btn-success btn-sm"><?php echo Lang('save');?></button>
          <button type="button" onClick="location.reload();" class="btn btn-success btn-sm"><?php echo Lang('reset');?></button>
        </td>
      </tr>
    </table>
  </form>
  <script>InitPage();</script>
</body>
</html>