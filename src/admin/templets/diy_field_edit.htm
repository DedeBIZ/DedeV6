<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <title><?php echo Lang('diy_edit_field');?></title>
  <link rel="stylesheet" href="../static/web/css/bootstrap.min.css">
  <link rel="stylesheet" href="../static/web/font/css/font-awesome.min.css">
  <link rel="stylesheet" href="../static/web/css/admin.min.css">
  <?php include_once(DEDEADMIN.'/templets/_widget_lang.htm');?>
  <script src="../static/web/js/jquery.min.js"></script>
  <script src="../static/web/js/bootstrap.bundle.min.js"></script>
  <script src="js/main.js"></script>
  <style>
  .style1 {color: #FF3300}
  .style2 {color: #545b62}
  .nw { float:left; width:150px; }
  .cls { clear:both; }
  </style>
  <script>
  function GetFields()
  {
  	var theform = document.form1;
  	var itemname = theform.itemname.value;
  	var fieldname = theform.fname.value;
  	var dtype = theform.dtype.value;
  	var isnull = theform.isnull.value;
  	var vdefault = theform.vdefault.value;
  	var maxlength = theform.maxlength.value;
  	var vinnertext = theform.vinnertext.value;
  	var spage = (theform.spage[0].checked ? theform.spage[0].value : theform.spage[1].value);
  	var sisnull = (isnull==0 ? "false" : "true");
  	if (itemname=="")
  	{
  		ShowMsg("<?php echo Lang('mychannel_err_itemname_isempty');?>");
  		theform.itemname.focus();
  		return false;
  	}
  	if ((dtype=="radio"||dtype=="select"||dtype=="checkbox") && vdefault=="")
  	{
  		ShowMsg("<?php echo Lang('mychannel_err_fieldname_dtype');?>");
  		return false;
  	}
  	if (spage=="no") spage = "";
  	revalue =  "<field:"+fieldname+" itemname=\""+itemname+"\" autofield=\"1\" type=\""+dtype+"\"";
  	revalue += " isnull=\""+sisnull+"\" default=\""+vdefault+"\" ";
  	revalue += " maxlength=\""+maxlength+"\" page=\""+spage+"\">"+vinnertext+"</field:"+fieldname+">";
  	document.form1.fieldstring.value = revalue;
    return true;
  }
  </script>
</head>
<body>
<table width="98%" align="center" cellpadding="1" cellspacing="1" class="table maintable mt-3 mb-3">
  <form name="form1" action="diy_field_edit.php" method="post" onSubmit="return GetFields();">
  	<input type="hidden" name="action" value="save">
  	<input type="hidden" name="diyid" value="<?php echo $diyid?>">
  	<input type="hidden" name="fname" value="<?php echo $fname?>">
	  <input type="hidden" name="issystem" value="<?php echo $issystem?>">
	  <input type="hidden" name="fieldstring" value="">
    <tr> 
      <td bgcolor="#f8f8f8" colspan="2">
        <table width="98%" cellspacing="0" cellpadding="0" class="table table-borderless">
          <tr> 
            <td width="30%"><a href="diy_main.php"><?php echo Lang('diy_main');?></a> &gt; <?php echo Lang('diy_edit_field');?></td>
            <td width="70%" align="right"><button type="button" name="ss1" onClick="location='diy_edit.php?diyid=<?php echo $diyid;?>&dopost=edit';" class="btn btn-success btn-sm"><?php echo Lang('diy_current');?></button></td>
          </tr>
        </table>
      </td>
    </tr>
    <tr> 
      <td><?php echo Lang('mychannel_itemname');?>：<br>
        <span class="style2"><?php echo Lang('mychannel_itemname_tip');?></span></td>
      <td><input type="text" name="itemname" id="itemname" value="<?php echo $ctag->GetAtt('itemname')?>" class="pubinputs"> </td>
    </tr>
    <tr> 
      <td width="28%"><?php echo Lang('mychannel_fieldname');?>：<br>
        <span class="style2"><?php echo Lang('mychannel_fieldname_tip2');?></span></td>
      <td width="72%" style="table-layout:fixed;word-break:break-all"><?php echo $fname?></td>
    </tr>
    <tr> 
      <td><?php echo Lang('mychannel_datatype');?>：</td>
      <td>
      	<select name="dtype" id="type" style="width:260px">
          <?php 
          $dtype = $ctag->GetAtt('type');
          if ($dtype!='' && isset($fieldtypes[$dtype]))
          {
          	echo "<option value='{$dtype}'>{$fieldtypes[$dtype]}</option>";
          	$canchange = true;
          } else {
          	echo "<option value='{$dtype}'>".Lang('mychannel_field_system')."</option>";
          	$canchange = false;
          }
          if ($canchange)
          {
          ?>
          <option value="text"><?php echo Lang('mychannel_fieldtype_text');?></option>
          <option value="textchar"><?php echo Lang('mychannel_fieldtype_textchar');?></option>
          <option value="multitext"><?php echo Lang('mychannel_fieldtype_multitext');?></option>
          <option value="htmltext"><?php echo Lang('mychannel_fieldtype_htmltext');?></option>
          <option value="int"><?php echo Lang('mychannel_fieldtype_int');?></option>
          <option value="float"><?php echo Lang('mychannel_fieldtype_float');?></option>
          <option value="datetime"><?php echo Lang('mychannel_fieldtype_datetime');?></option>
          <option value="img"><?php echo Lang('mychannel_fieldtype_img');?></option>
          <option value="addon"><?php echo Lang('mychannel_fieldtype_addon');?></option>
          <option value="select"><?php echo Lang('mychannel_fieldtype_select');?></option>
          <option value="radio"><?php echo Lang('mychannel_fieldtype_radio');?></option>
          <option value="checkbox"><?php echo Lang('mychannel_fieldtype_checkbox');?></option>
          <?php }?>
        </select>
      </td>
    </tr>
    <tr> 
      <td><?php echo Lang('mychannel_field_spage');?>：<br>
        <span class="style2"><?php echo Lang('mychannel_field_spage_tip');?></span></td>
      <td>
      	<input type="hidden" name="isnull" value="1">
        <label><input type="radio" name="spage" value="split" <?php if ($ctag->GetAtt('page')=='split') echo 'checked="1"';?>> <?php echo Lang('yes');?></label>
        <label><input type="radio" name="spage" value="no" <?php if ($ctag->GetAtt('page')=='no'||$ctag->GetAtt('page')=='') echo 'checked="1"';?>> <?php echo Lang('no');?></label>
      </td>
    </tr>
    <tr> 
      <td><?php echo Lang('mychannel_field_vdefault');?>：<br>
        <span class="style2"> <?php echo Lang('mychannel_field_vdefault_tip');?></span></td>
      <td><textarea name="vdefault" id="vdefault" style="width:70%;height:60px"><?php echo $ctag->GetAtt('default');?></textarea></td>
    </tr>
    <tr> 
      <td><?php echo Lang('mychannel_field_maxlength');?>：<br>
        <span class="style2"> <?php echo Lang('mychannel_field_maxlength_tip');?></span></td>
      <td><input type="text" name="maxlength" id="maxlength" value="<?php echo $ctag->GetAtt('maxlength')?>" style="width:80px;padding-top:6px"></td>
    </tr>
    <tr>
      <td><?php echo Lang('mychannel_field_vinnertext');?>：</td>
      <td><?php echo Lang('mychannel_field_vinnertext_tip');?></td>
    </tr>
    <tr> 
      <td></td>
      <td><textarea name="vinnertext" cols="45" rows="5" id="vinnertext" style="width:70%;height:120px"><?php echo $ctag->GetInnerText();?></textarea></td>
    </tr>
    <tr>
      <td colspan="2" bgcolor="#f8f8f8">
        <table width="100%" cellspacing="0" cellpadding="0" class="table table-borderless mb-3">
          <tr>
            <td align="center" class="py-2">
              <button type="submit" class="btn btn-success btn-sm"><?php echo Lang('save');?></button>
              <button type="reset" class="btn btn-success btn-sm"><?php echo Lang('reset');?></button>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </form>
</table>
</body>
</html>