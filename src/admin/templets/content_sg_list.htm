<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<title><?php echo Lang('content_main');?></title>
	<link rel="stylesheet" href="../static/web/css/bootstrap.min.css">
	<link rel="stylesheet" href="../static/web/font/css/font-awesome.min.css">
	<link rel="stylesheet" href="../static/web/css/admin.min.css">
	<?php include_once(DEDEADMIN.'/templets/_widget_lang.htm');?>
	<script src="../static/web/js/jquery.min.js"></script>
	<script src="../static/web/js/bootstrap.bundle.min.js"></script>
	<script src="../static/web/js/webajax.js"></script>
	<script src="js/ieemu.js"></script>
	<script src="js/main.js"></script>
	<script>
		if (moz) {
			extendEventObject();
			extendElementModel();
			emulateAttachEvent();
		}
		function viewArc(aid) {
			if (aid == 0) aid = getOneItem();
			window.open("archives_do.php?aid=" + aid + "&dopost=viewArchives");
		}
		function editArc(aid) {
			if (aid == 0) aid = getOneItem();
			location = "archives_do.php?aid=" + aid + "&dopost=editArchives";
		}
		function checkArc(aid) {
			var qstr = getCheckboxItem();
			if (aid == 0) aid = getOneItem();
			location = "archives_do.php?aid=" + aid + "&dopost=checkArchives&qstr=" + qstr;
		}
		function updateArc(aid) {
			var qstr = getCheckboxItem();
			if (aid == 0) aid = getOneItem();
			location = "archives_do.php?aid=" + aid + "&dopost=makeArchives&qstr=" + qstr;
		}
		function moveArc(aid) {
			var qstr = getCheckboxItem();
			if (aid == 0) aid = getOneItem();
			location = "archives_do.php?aid=" + aid + "&dopost=moveArchives&qstr=" + qstr;
		}
		function delArc(aid) {
			var qstr = getCheckboxItem();
			if (qstr == '') {
				ShowMsg('必须选择一个或多个文档');
				return;
			}
			if (aid == 0) aid = getOneItem();
			location = "archives_do.php?qstr=" + qstr + "&aid=" + aid + "&dopost=delArchives";
		}
		function adArc(aid) {
			var qstr = getCheckboxItem();
			if (aid == 0) aid = getOneItem();
			location = "archives_do.php?aid=" + aid + "&dopost=commendArchives&qstr=" + qstr;
		}
		function moveArc(e, obj, cid) {
			var qstr = getCheckboxItem();
			if (qstr == '') {
				ShowMsg('必须选择一个或多个文档');
				return;
			}
			LoadQuickDiv(e, 'archives_do.php?dopost=moveArchives&qstr=' + qstr + '&channelid=' + cid + '&rnd=' + Math.random(), 'moveArchives', '450px', '180px');
			ChangeFullDiv('show');
		}
		//获得选中文件的文件名
		function getCheckboxItem() {
			var allSel = "";
			if (document.form2.arcID.value) return document.form2.arcID.value;
			for (i = 0; i < document.form2.arcID.length; i++) {
				if (document.form2.arcID[i].checked) {
					if (allSel == "")
						allSel = document.form2.arcID[i].value;
					else
						allSel = allSel + "`" + document.form2.arcID[i].value;
				}
			}
			return allSel;
		}
		function getCheckboxItem2() {
			var allSel = "";
			if (document.form2.arcID.value) return document.form2.arcID.value;
			for (i = 0; i < document.form2.arcID.length; i++) {
				if (document.form2.arcID[i].checked) {
					if (allSel == "")
						allSel = document.form2.arcID[i].value;
					else
						allSel = allSel + "," + document.form2.arcID[i].value;
				}
			}
			return allSel;
		}
		//获得选中其中一个的id
		function getOneItem() {
			var allSel = "";
			if (document.form2.arcID.value) return document.form2.arcID.value;
			for (i = 0; i < document.form2.arcID.length; i++) {
				if (document.form2.arcID[i].checked) {
					allSel = document.form2.arcID[i].value;
					break;
				}
			}
			return allSel;
		}
		function selAll() {
			for (i = 0; i < document.form2.arcID.length; i++) {
				if (!document.form2.arcID[i].checked) {
					document.form2.arcID[i].checked = true;
				}
			}
		}
		function noSelAll() {
			for (i = 0; i < document.form2.arcID.length; i++) {
				if (document.form2.arcID[i].checked) {
					document.form2.arcID[i].checked = false;
				}
			}
		}
	</script>
</head>
<body>
	<table width="98%" align="center" cellspacing="0" cellpadding="0" class="table maintable mt-3 mb-3">
		<tr>
			<td>
				<button type='button' class="btn btn-success btn-sm" onClick="location='catalog_do.php?channelid={dede:global.channelid/}&cid={dede:global.cid/}&dopost=addArchives';"><?php echo Lang('content_add');?></button>
				{dede:if $adminid==$mid }
				<button type='button' class="btn btn-success btn-sm" onClick="location='content_list.php?cid={dede:global.cid/}&mid=0';"><?php echo Lang('content_all');?></button>
				{else}
				<button type='button' class="btn btn-success btn-sm" onClick="location='content_list.php?cid={dede:global.cid/}&mid=<?php echo $cUserLogin->getUserID();?>';"><?php echo Lang('content_my');?></button>
				{/dede:if}
				<button type='button' class="btn btn-success btn-sm" onClick="location='catalog_main.php';"><?php echo Lang('catalog_main');?></button>
				<button type='button' class="btn btn-success btn-sm" name='bb1' onClick="location='makehtml_list.php?cid={dede:global.cid/}';"><?php echo Lang('makehtml_list');?></button>
				<button type='button' class="btn btn-success btn-sm" name='bb2' onClick="location='makehtml_archives.php?cid={dede:global.cid/}';"><?php echo Lang('makehtml_archives');?></button>
				<?php echo $CheckUserSend;?>
			</td>
		</tr>
	</table>
	<form name="form3" action="content_sg_list.php" method="get">
		<input type="hidden" name="dopost" value="listArchives">
		<table width="98%" align="center" cellpadding="1" cellspacing="1" class="mb-3 biz-border">
			<tr>
				<td height="36" bgcolor="#f8f8f8">
					<table cellpadding="0" cellspacing="0">
						<tr>
							<td width="180" align="center">
								<select name="cid" style="width:160px">
									<option value="0"><?php echo Lang('catalog_select');?></option>
									{dede:global.optionarr/}
								</select>
							</td>
							<td width="270"><input type="text" name="keyword" placeholder="<?php echo Lang('input_keywords_tip');?>" value="{dede:global.keyword/}" style="width:260px"></td>
							<td><button type="submit" class="btn btn-success btn-sm"><?php echo Lang('search');?></button></td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
	</form>
	<table width="98%" align="center" cellpadding="2" cellspacing="1" class="table maintable mb-3">
		<tr>
			<td bgcolor="#f8f8f8" colspan="9">{dede:global.positionname/}<?php echo Lang('content_list2');?></td>
		</tr>
		<form name="form2">
			<tr align="center" bgcolor="#f8fcf2">
				<td width="6%">id</td>
				<td width="6%"><?php echo Lang('select');?></td>
				<td width="30%"><?php echo Lang('title');?></td>
				<td width="10%"><?php echo Lang('senddate');?></td>
				<td width="14%"><?php echo Lang('catalog');?></td>
				<td width="9%"><?php echo Lang('click');?></td>
				<td width="9%"><?php echo Lang('arcrank');?></td>
				<td width="6%"><?php echo Lang('content_admin');?></td>
				<td width="10%"><?php echo Lang('operation');?></td>
			</tr>
			{dede:datalist empty='<tr><td colspan="9"><center>~lang:none_result~</center></td></tr>'}
			<tr align="center" onmousemove="javascript:this.bgColor='#f8fcf2';" onmouseout="javascript:this.bgColor='#ffffff';">
				<td>{dede:field.id/}</td>
				<td><input type="checkbox" name="arcID" id="arcID" value="{dede:field.aid/}"></td>
				<td align="left"><a href="archives_do.php?aid={dede:field.aid/}&dopost=editArchives">{dede:field.title/}{dede:field.flag function='IsCommendArchives(@me)'/}</a></td>
				<td>{dede:field.senddate function='GetDateMk(@me)'/}</td>
				<td>{dede:field.typename/}</td>
				<td>{dede:field.arcrank function="GetRankName(@me)"/}</td>
				<td>{dede:field.click/}</td>
				<td>{dede:field.mid function=GetMemberName(@me)/}</td>
				<td>
					<a href="javascript:editArc({dede:field.aid/})" class="btn btn-success btn-sm" title="<?php echo Lang('edit');?>"><i class="fa fa-code"></i></a>
					<a href="javascript:viewArc({dede:field.aid/})" class="btn btn-success btn-sm" title="预览"><i class="fa fa-globe"></i></a>
				</td>
			</tr>
			{/dede:datalist}
			<tr>
				<td colspan="9" class="py-2" style="margin-left:10px">
					<a class="btn btn-success btn-sm" href="javascript:selAll()" class="coolbg"><?php echo Lang('select_all');?></a>
					<a class="btn btn-success btn-sm" href="javascript:noSelAll()" class="coolbg"><?php echo Lang('cancel');?></a>
					<a class="btn btn-success btn-sm" href="javascript:updateArc(0)" class="coolbg"><?php echo Lang('update');?></a>
					<a class="btn btn-success btn-sm" href="javascript:checkArc(0)" class="coolbg"><?php echo Lang('auditing');?></a>
					<a class="btn btn-success btn-sm" href="javascript:adArc(0)" class="coolbg"><?php echo Lang('recommend');?></a>
					<a class="btn btn-success btn-sm" href="javascript:;" onClick="moveArc(event,this,<?php echo (empty($channelid) ? 0 : $channelid);?>)" class="coolbg"><?php echo Lang('move');?></a>
					<a class="btn btn-danger btn-sm" href="javascript:delArc(0)" class="coolbg"><?php echo Lang('delete');?></a>
					<?php if (!empty($f)) {?>
					<a href="javascript:ReturnValue()" class="btn btn-success btn-sm"><?php echo Lang('content_select_add');?></a>
					<?php }?>
				</td>
			</tr>
		</form>
		<tr>
			<td align="center" colspan="9"bgcolor="#f8f8f8" class="py-2">{dede:pagelist listsize='6'/}</td>
		</tr>
	</table>
</body>
</html>